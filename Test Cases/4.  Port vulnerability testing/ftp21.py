import ftplib
import json

def check_ftp_vulnerability(ip, port=21):
    # Load credentials
    try:
        with open("credentials.json", "r") as file:
            credentials = json.load(file)
    except Exception as e:
        print("Error loading credentials file: " + str(e))
        return False

    print("Scanning ftp://" + ip + ":" + str(port) + " for FTP login vulnerabilities...")

    for entry in credentials:
        username = entry["username"]
        password = entry["password"]

        try:
            ftp = ftplib.FTP()
            ftp.connect(ip, port, timeout=3)
            ftp.login(user=username, passwd=password)
            print("Access granted with " + username + " / " + password)
            print("FTP (port 21) is vulnerable.")
            ftp.quit()
            return True
        except ftplib.error_perm:
            # print("Login failed for " + username)
            continue
        except Exception as e:
            print("Connection error for " + username + ": " + str(e))

    print("FTP (port 21) is not vulnerable with given credentials.")
    return False

if __name__ == "__main__":
    target_ip = input("Enter target IP: ").strip()
    check_ftp_vulnerability(target_ip)
