import requests
import json

def check_http_vulnerability(ip, port):
    url = f"http://{ip}:{port}/"  # Adjust if you know the exact login path

    with open("credentials.json", "r") as file:
        credentials = json.load(file)

    print(f"Scanning {url}\n")

    for entry in credentials:
        username = entry["username"]
        password = entry["password"]
        # print(f"Trying {username} / {password}")

        try:
            response = requests.post(
                url,
                data={"username": username, "password": password}, 
                timeout=3
            )

            if "logout" in response.text.lower() or "admin" in response.text.lower():
                print("HTTP attempted possible.")
                print(f"Access granted with {username} / {password}")
                return True
            # else:
            #     print("Login failed")

        except Exception as e:
            print(f"Connection error: {e}")
            # continue

    print("HTTPS attempted is not possible")
    return False

if __name__ == "__main__":
    target_ip = input("Enter target IP: ").strip()
    target_port = input("Enter port (default 80): ").strip()
    port = int(target_port) if target_port else 80
    check_http_vulnerability(target_ip, port)
