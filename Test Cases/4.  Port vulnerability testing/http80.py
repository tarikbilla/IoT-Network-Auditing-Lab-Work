import requests
from requests.auth import HTTPBasicAuth
import json

def check_http_vulnerability(ip, port):
    url = f"http://{ip}:{port}"

    # Load credentials
    with open("credentials-5k.json", "r") as file:
        credentials = json.load(file)

    print(f"Scanning {url}\n")

    # Try credentials from file
    for entry in credentials:
        username = entry["username"]
        password = entry["password"]
        # print(f"Trying with {username} : {password}")

        try:
            response = requests.get(url, auth=HTTPBasicAuth(username, password), timeout=3)

            if response.status_code == 200:
                print(f"Access granted with Username:{username} Password:{password}")
                print("HTTP is vulnerable.")
                return True

            # elif response.status_code == 401:
                # print("Unauthorized\n")
            # else:
                # print(f"HTTP {response.status_code} returned")

        except Exception as e:
            print(f"Connection error: {e}")

    print("HTTP Attempted Not Possible.")
    return False

if __name__ == "__main__":
    target_ip = input("Enter target IP: ").strip()
    target_port = input("Enter port (default 80): ").strip()
    port = int(target_port) if target_port else 80
    check_http_vulnerability(target_ip, port)