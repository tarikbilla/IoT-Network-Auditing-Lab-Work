import requests
import json

def check_https_vulnerability(ip, port):
    url = f"https://{ip}:{port}/"  # Adjust path if needed

    with open("credentials.json", "r") as file:
        credentials = json.load(file)

    print(f"Scanning {url} for HTTPS login vulnerabilities...")

    for entry in credentials:
        username = entry["username"]
        password = entry["password"]
        # print(f"Trying {username} / {password}")

        try:
            response = requests.post(
                url,
                data={"username": username, "password": password},
                timeout=3,
                verify=False 
            )

            if "logout" in response.text.lower() or "admin" in response.text.lower():
                print(f"Access granted with {username} / {password}")
                print("HTTPS is vulnerable.")
                return True
            # else:
            #     print("Login failed")

        except Exception as e:
            print(f"Connection error: {e}")

    print("No valid credentials found.")
    return False

if __name__ == "__main__":
    target_ip = input("Enter target IP: ").strip()
    target_port = input("Enter port (default 443): ").strip()
    port = int(target_port) if target_port else 443
    check_https_vulnerability(target_ip, port)
