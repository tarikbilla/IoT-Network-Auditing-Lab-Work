import telnetlib
import json

host = "127.0.0.1"
port = 23

# Load credentials from JSON file
with open("credentials.json", "r") as file:
    credentials = json.load(file)

# Try each username/password
for entry in credentials:
    username = entry["username"]
    password = entry["password"]
    print(f"Trying with username:{username} password:{password}")

    try:
        tn = telnetlib.Telnet(host, port, timeout=2)

        tn.read_until(b"login: ")
        tn.write(username.encode('ascii') + b"\n")

        tn.read_until(b"Password: ")
        tn.write(password.encode('ascii') + b"\n")

        result = tn.read_until(b"$", timeout=2).decode('ascii')

        if "$" in result:
            print(f"Port 23 is Vulnerable! username:{username} password:{password}")
            break
        else:
            print("Login Failed\n")
            tn.close()

    except Exception as e:
        print(f"Error: {e}")
    

else:
    print("Port 23 is Not Vulnerable!")
